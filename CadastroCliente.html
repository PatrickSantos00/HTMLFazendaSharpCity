<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FazendaSharpCity</title>
    <link rel="apple-touch-icon" sizes="180x180" href="./Images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="./Images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./Images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="./Images/favicon_io/site.webmanifest">
    <link media="screen" href="./Styles/MainStyle.css" type="text/css" rel="stylesheet">
    <link media="screen" href="./Styles/CadastroCliente.css" type="text/css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/1875de819e.js" crossorigin="anonymous"></script>
</head>

<body>
    <div class="background-image">
        <div class="login-container">
            <h1><span class="highlight">Cadastro <span class="green">Cliente</span></span></h1>
            <form id="form-cadastro" onsubmit="return validarFormulario()">
                <div class="form-split">
                    <div class="form-left">
                        <label for="nome">NOME</label>
                        <input type="text" id="nome" name="nome" placeholder="Digite seu nome" required>

                        <label for="telefone">TELEFONE</label>
                        <input type="tel" id="telefone" name="telefone" placeholder="Digite seu telefone" required>

                        <label for="tipoDocumento">Tipo de Documento</label>
                        <select id="tipoDocumento" name="tipoDocumento" onchange="alterarDocumento()" required>
                            <option value="" disabled selected>Selecione</option>
                            <option value="cpf">CPF</option>
                            <option value="cnpj">CNPJ</option>
                        </select>

                        <div class="form-group" id="div-cpf" style="display: none;">
                            <label for="cpf">CPF</label>
                            <input type="text" id="cpf" name="cpf" placeholder="Digite seu CPF">
                        </div>

                        <div class="form-group" id="div-cnpj" style="display: none;">
                            <label for="cnpj">CNPJ</label>
                            <input type="text" id="cnpj" name="cnpj" placeholder="Digite seu CNPJ">
                        </div>

                        <label for="cep">CEP</label>
                        <input type="text" id="cep" name="cep" placeholder="Digite seu CEP" required>

                        <label for="email">E-MAIL</label>
                        <input type="email" id="email" name="email" placeholder="Digite seu email" required>

                        <label for="uf">UF</label>
                        <select id="uf" name="uf" required>
                            <option value="" disabled selected>Selecione</option>
                            <option value="AC">AC</option>
                            <option value="AL">AL</option>
                            <option value="AP">AP</option>
                            <option value="AM">AM</option>
                            <option value="BA">BA</option>
                            <option value="CE">CE</option>
                            <option value="DF">DF</option>
                            <option value="ES">ES</option>
                            <option value="GO">GO</option>
                            <option value="MA">MA</option>
                            <option value="MT">MT</option>
                            <option value="MS">MS</option>
                            <option value="MG">MG</option>
                            <option value="PA">PA</option>
                            <option value="PB">PB</option>
                            <option value="PR">PR</option>
                            <option value="PE">PE</option>
                            <option value="PI">PI</option>
                            <option value="RJ">RJ</option>
                            <option value="RN">RN</option>
                            <option value="RS">RS</option>
                            <option value="RO">RO</option>
                            <option value="RR">RR</option>
                            <option value="SC">SC</option>
                            <option value="SP">SP</option>
                            <option value="SE">SE</option>
                            <option value="TO">TO</option>
                        </select>
                    </div>

                    <div class="form-right">
                        <label for="cidade">CIDADE</label>
                        <input type="text" id="cidade" name="cidade" placeholder="Digite a cidade" required>

                        <label for="endereco">ENDEREÇO</label>
                        <input type="text" id="endereco" name="endereco" placeholder="Digite seu endereço" required>

                        <label for="logradouro">LOGRADOURO</label>
                        <input type="text" id="logradouro" name="logradouro" placeholder="Digite o logradouro" required>

                        <label for="bairro">BAIRRO</label>
                        <input type="text" id="bairro" name="bairro" placeholder="Digite o bairro" required>

                        <label for="numero">NÚMERO</label>
                        <input type="text" id="numero" name="numero" placeholder="Digite o número" required>

                        <label for="complemento">COMPLEMENTO</label>
                        <input type="text" id="complemento" name="complemento" placeholder="Digite o complemento">
                    </div>
                </div>

                <div id="validation-errors" style="color: red; margin-top: 10px;"></div>

                <div class="form-buttons">
                    <button type="submit" class="login-button">CADASTRAR</button>
                    <button onclick="voltar()" type="button" class="signup-button">VOLTAR</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        function alterarDocumento() {
            const tipoDocumento = document.getElementById('tipoDocumento').value;
            const divCpf = document.getElementById('div-cpf');
            const divCnpj = document.getElementById('div-cnpj');

            if (tipoDocumento === 'cpf') {
                divCpf.style.display = 'block';
                divCnpj.style.display = 'none';
                document.getElementById('cnpj').value = ''; // Limpa o campo CNPJ
            } else if (tipoDocumento === 'cnpj') {
                divCnpj.style.display = 'block';
                divCpf.style.display = 'none';
                document.getElementById('cpf').value = ''; // Limpa o campo CPF
            }
        }

        document.getElementById('form-cadastro').addEventListener('submit', async (event) => {
            event.preventDefault();

            const tipoDocumento = document.getElementById('tipoDocumento').value;
            let documento = '';

            if (tipoDocumento === 'cpf') {
                documento = document.getElementById('cpf').value;
                if (!validarCPF(documento)) {
                    document.getElementById('validation-errors').textContent = 'CPF inválido!';
                    return;
                }
            } else if (tipoDocumento === 'cnpj') {
                documento = document.getElementById('cnpj').value;
                if (!validarCNPJ(documento)) {
                    document.getElementById('validation-errors').textContent = 'CNPJ inválido!';
                    return;
                }
            } else {
                document.getElementById('validation-errors').textContent = 'Selecione CPF ou CNPJ!';
                return;
            }

            const cliente = {
                nome: document.getElementById('nome').value,
                telefone: document.getElementById('telefone').value,
                email: document.getElementById('email').value,
                cpf: tipoDocumento === 'cpf' ? documento : null,
                cnpj: tipoDocumento === 'cnpj' ? documento : null,
                enderecoId: 0
            };

            // Enviar dados para as APIs (continuação do código anterior)
        });

    </script>

    <script>
        function validarCPF(cpf) {
            cpf = cpf.replace(/[^\d]+/g, ''); // Remove caracteres não numéricos
            if (cpf.length !== 11 || /^(\d)\1+$/.test(cpf)) return false;

            let soma = 0, resto;
            for (let i = 1; i <= 9; i++) soma += parseInt(cpf.substring(i - 1, i)) * (11 - i);
            resto = (soma * 10) % 11;
            if (resto === 10 || resto === 11) resto = 0;
            if (resto !== parseInt(cpf.substring(9, 10))) return false;

            soma = 0;
            for (let i = 1; i <= 10; i++) soma += parseInt(cpf.substring(i - 1, i)) * (12 - i);
            resto = (soma * 10) % 11;
            if (resto === 10 || resto === 11) resto = 0;
            return resto === parseInt(cpf.substring(10, 11));
        }

        function validarCNPJ(cnpj) {
            cnpj = cnpj.replace(/[^\d]+/g, ''); // Remove caracteres não numéricos
            if (cnpj.length !== 14 || /^(\d)\1+$/.test(cnpj)) return false;

            let tamanho = cnpj.length - 2, numeros = cnpj.substring(0, tamanho);
            let digitos = cnpj.substring(tamanho);
            let soma = 0, pos = tamanho - 7;

            for (let i = tamanho; i >= 1; i--) {
                soma += numeros.charAt(tamanho - i) * pos--;
                if (pos < 2) pos = 9;
            }

            let resultado = soma % 11 < 2 ? 0 : 11 - (soma % 11);
            if (resultado !== parseInt(digitos.charAt(0))) return false;

            tamanho++;
            numeros = cnpj.substring(0, tamanho);
            soma = 0;
            pos = tamanho - 7;

            for (let i = tamanho; i >= 1; i--) {
                soma += numeros.charAt(tamanho - i) * pos--;
                if (pos < 2) pos = 9;
            }

            resultado = soma % 11 < 2 ? 0 : 11 - (soma % 11);
            return resultado === parseInt(digitos.charAt(1));
        }

    </script>

    <script src="./js/CadastroClienteAPI.js"></script>
    <script>
        function voltar() {
            window.history.back();
        }
    </script>
</body>

</html>